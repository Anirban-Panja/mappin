<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accelerometer Calibration and Data</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
    }
    #output {
        margin-top: 20px;
    }
</style>
</head>
<body>
<h1>Accelerometer Calibration and Data</h1>
<div id="output">
    <p id="accelerationXDisplay">Acceleration along the X-axis: <span id="accelerationX">0</span></p>
    <p id="accelerationYDisplay">Acceleration along the Y-axis: <span id="accelerationY">0</span></p>
</div>

<script>
    if ('Accelerometer' in window) {
        const acl = new Accelerometer({ frequency: 60 });
        let calibrationData = [];
        let calibrationDuration = 1000; // Calibration duration in milliseconds (5 seconds)
        let calibrationCompleted = false;
        let avgX = 0;
        let avgY = 0;

        acl.addEventListener("reading", function() {
            if (!calibrationCompleted) {
                calibrationData.push({ x: acl.x, y: acl.y });
            } else {
                // Calibrate the accelerometer data
                let calibratedX = acl.x - avgX;
                let calibratedY = acl.y - avgY;

                document.getElementById("accelerationX").textContent = calibratedX.toFixed(2);
                document.getElementById("accelerationY").textContent = calibratedY.toFixed(2);
            }
        });

        setTimeout(() => {
            if (calibrationData.length > 0) {
                let sumX = calibrationData.reduce((acc, curr) => acc + curr.x, 0);
                let sumY = calibrationData.reduce((acc, curr) => acc + curr.y, 0);
                avgX = sumX / calibrationData.length;
                avgY = sumY / calibrationData.length;

                document.getElementById("output").innerHTML = `
                    <div id="calibrationResults">
                        <p>Calibration complete.</p>
                        <p>Average X-axis value: ${avgX.toFixed(2)}</p>
                        <p>Average Y-axis value: ${avgY.toFixed(2)}</p>
                        <p>You can now use the sensor.</p>
                    </div>
                `;

                calibrationCompleted = true;
            } else {
                document.getElementById("output").innerHTML += `<p>No data collected for calibration.</p>`;
            }
        }, calibrationDuration);

        acl.start();
    } else {
        console.error('Accelerometer not supported.');
    }
</script>
</body>
</html>
