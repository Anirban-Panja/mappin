<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accelerometer Calibration</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
    }
    #output {
        margin-top: 20px;
    }
</style>
</head>
<body>
<h1>Accelerometer Calibration</h1>
<div id="instructions">
    <p>Please hold the phone flat on your palm or keep the phone on a flat surface in a stationary position for calibration.</p>
</div>
<div id="output">
    <p>Calibrating...</p>
</div>

<script>
    if ('Accelerometer' in window) {
        const acl = new Accelerometer({ frequency: 60 });
        let calibrationData = [];
        let calibrationDuration = 10000; // Calibration duration in milliseconds (10 seconds)
        let calibrationCompleted = false;

        acl.addEventListener("reading", function() {
            if (!calibrationCompleted) {
                calibrationData.push({ x: acl.x, y: acl.y });
            } else {
                document.getElementById("accelerationX").textContent = acl.x.toFixed(2);
                document.getElementById("accelerationY").textContent = acl.y.toFixed(2);
            }
        });

        setTimeout(() => {
            if (calibrationData.length > 0) {
                let sumX = calibrationData.reduce((acc, curr) => acc + curr.x, 0);
                let sumY = calibrationData.reduce((acc, curr) => acc + curr.y, 0);
                let avgX = sumX / calibrationData.length;
                let avgY = sumY / calibrationData.length;

                document.getElementById("output").innerHTML = `
                    <p>Calibration complete.</p>
                    <p>Average X-axis value: ${avgX.toFixed(2)}</p>
                    <p>Average Y-axis value: ${avgY.toFixed(2)}</p>
                    <p>You can now use the sensor.</p>
                `;

                calibrationCompleted = true;
                acl.start();
            } else {
                document.getElementById("output").innerHTML = `<p>No data collected for calibration.</p>`;
            }
        }, calibrationDuration);
    } else {
        console.error('Accelerometer not supported.');
    }
</script>
</body>
</html>
